a = 0.15
jpeg(file="ofig1.jpg", quality=100, width=900, height=900)
x = c(1,2,3)
y = c(1,1,4)
par(mar=c(0,0,0,0)+a)
plot(x,y,cex=3,pch=19, xlim=c(0.5,3.5),ylim=c(0.5,4.5), cex.lab=2, xaxt='n', yaxt='n', asp=1, xlab="", ylab="")
abline(h=seq(1,4),v=seq(1,3), col="#00000031")
points(x,y,cex=3,pch=19)
text(x[1]+a,y[1]-a,labels="(1,1)", cex=2.5)
text(x[2]+a,y[2]-a,labels="(2,1)", cex=2.5)
text(x[3]+a,y[3]-a,labels="(3,4)", cex=2.5)
dev.off()


mx = mean(x)
my = mean(y)

jpeg(file="ofig2.jpg", quality=100, width=900, height=900)
par(mar=c(0,0,0,0)+a)
plot(x,y,cex=3,pch=19, xlim=c(0.5,3.5),ylim=c(0.5,4.5), cex.lab=2, xaxt='n', yaxt='n', asp=1, xlab="", ylab="")
abline(h=seq(1,4),v=seq(1,3), col="#00000031")
points(x,y,cex=3,pch=19)
points(mx,my,cex=3,lwd=4,col=4,pch=19)
text(x[1]+a,y[1]-a,labels="(1,1)", cex=2.5)
text(x[2]+a,y[2]-a,labels="(2,1)", cex=2.5)
text(x[3]+a,y[3]-a,labels="(3,4)", cex=2.5)
text(mx-a,my+a,labels="(2,2)", cex=2.5)
text(mx+2*a,my-a,labels="(average)", cex=2.5)
dev.off()

x = x - mx
y = y - my
mx = mean(x)
my = mean(y)
a = 0.25
jpeg(file="ofig3.jpg", quality=100, width=900, height=900)
par(mar=c(0,0,0,0)+a)
plot(x,y,cex=3,pch=19, xlim=c(-1.5,1.5),ylim=c(-2.5,2.5), cex.lab=2, xaxt='n', yaxt='n', asp=1, xlab="", ylab="")
abline(h=seq(-2,2),v=seq(-2,2), col="#00000031")
points(x,y,cex=3,pch=19)
points(mx,my,cex=3,lwd=4,col=4, pch=19)
text(x[1]+a,y[1]-a,labels="(-1,-1)", cex=2.5)
text(x[2]+a,y[2]-a,labels="(0,-1)", cex=2.5)
text(x[3]+a,y[3]-a,labels="(1,2)", cex=2.5)
text(mx-a,my+a,labels="(0,0)", cex=2.5)
dev.off()

m = lm(y ~ ., data=data.frame(x=x, y=y))
jpeg(file="ofig4.jpg", quality=100, width=900, height=900)
par(mar=c(0,0,0,0)+a)
plot(x,y,cex=3,pch=19, xlim=c(-1.5,1.5),ylim=c(-2.5,2.5), cex.lab=2, xaxt='n', yaxt='n', asp=1)
abline(h=seq(-2,2),v=seq(-1,1), col="#00000031")
points(x,y,cex=3,pch=19)
text(x[1],y[1]+a,labels="(-1,-1)", cex=2.5)
text(x[2]+a,y[2]-a,labels="(0,-1)", cex=2.5)
text(x[3]+a,y[3]+a,labels="(1,2)", cex=2.5)
text(mx-a,my+a,labels="(0,0)", cex=2.5)
abline(m)
points(mx,my,cex=3,lwd=4,col=4, pch=19)
dev.off()

jpeg(file="ofig5.jpg", quality=100, width=900, height=900)
par(mar=c(0,0,0,0)+a)
plot(x,y,cex=3,pch=19, xlim=c(-1.5,1.5),ylim=c(-2.5,2.5), cex.lab=2, xaxt='n', yaxt='n', asp=1, ylab="", xlab="")
abline(h=seq(-2,2),v=seq(-1,1), col="#00000031")
points(x,y,cex=3,pch=19)
text(x[1],y[1]+a,labels="(-1,-1)", cex=2.5)
text(x[2]+a,y[2]-a,labels="(0,-1)", cex=2.5)
text(x[3]+a,y[3]+a,labels="(1,2)", cex=2.5)
abline(m, lwd=2)
mm = m
mm$coefficients = c(0,0.1)
abline(mm, lwd=2, lty=2)
dev.off()

jpeg(file="ofig6.jpg", quality=100, width=900, height=900)
par(mar=c(0,0,0,0)+a)
plot(x,y,cex=3,pch=19, xlim=c(-1.5,1.5),ylim=c(-2.5,2.5), cex.lab=2, xaxt='n', yaxt='n', asp=1, xlab="", ylab="")
abline(h=seq(-2,2),v=seq(-1,1), col="#00000031")
points(x,y,cex=3,pch=19)
text(x[1],y[1]+a,labels="(-1,-1)", cex=2.5)
text(x[2]+a,y[2]-a,labels="(0,-1)", cex=2.5)
text(x[3]+a,y[3]+a,labels="(1,2)", cex=2.5)
abline(m, lwd=2)
mm = m
mm$coefficients = c(0,2)
abline(mm, lwd=2, lty=2)
dev.off()


jpeg(file="ofig7.jpg", quality=100, width=900, height=900)
par(mar=c(0,0,0,0)+a)
plot(x,y,cex=3,pch=19, xlim=c(-1.5,1.5),ylim=c(-2.5,2.5), cex.lab=2, xaxt='n', yaxt='n', asp=1, xlab="", ylab="")
abline(h=seq(-2,2),v=seq(-1,1), col="#00000031")
text(x[1],y[1]+a,labels="(-1,-1)", cex=2.5)
text(x[2]+a,y[2]-a,labels="(0,-1)", cex=2.5)
text(x[3]+a,y[3]+a,labels="(1,2)", cex=2.5)
abline(m)
points(x,y,cex=3,pch=19)
lines(c(x[1],x[1]), c(y[1],1.5*x[1]), lwd=3, col=4, lty=3)
lines(c(x[2],x[2]), c(y[2],1.5*x[2]), lwd=3, col=4, lty=3)
lines(c(x[3],x[3]), c(y[3],1.5*x[3]), lwd=3, col=4, lty=3)
text(x[1]+a,1.5*x[1]-a,labels=expression('(-1,y'[1]*')'), cex=2.5, col=4)
text(x[2]+a,1.5*x[2]-a,labels=expression('(0,y'[2]*')'), cex=2.5, col=4)
text(x[3]+a,1.5*x[3]-a,labels=expression('(1,y'[3]*')'), cex=2.5, col=4)
points(x,1.5*x,cex=3,col=4, pch=19)
dev.off()

f = function(x) 2*x^2 - 6*x + 6
fx = seq(from=0, to=3, length.out=100)
jpeg(file="ofig8.jpg", quality=100, width=900, height=900)
par(mar=c(5,5,4,2)+a)
plot(fx, f(fx), type='l', lwd=3, xlab="m", ylab=expression('d'), cex.lab=2, asp=1, cex.axis=2)
grid()
dev.off()

set.seed(1)
N = 50
x = round(rnorm(N)*10)
y = round((2 + 2*rnorm(N)) * x)
mx = mean(x)
my = mean(y)
xx = x - mx
yy = y - my
m = sum(xx * yy) / sum(xx * xx)
b = my - m * mx
l = lm(y ~ ., data=data.frame(x=x,y=y))
print(l)
print(c(b, m))
jpeg(file="ofig9.jpg", quality=100, width=900)
par(mar=c(5,5,4,2)+a)
plot(x, y, pch=19, cex=1.2)
abline(l, lwd=3, col=4)
dev.off()

